{"version":3,"sources":["scripts.js"],"names":["ftfHelpers","ready","fn","document","readyState","addEventListener","processTweets","tweets","querySelectorAll","tweetIds","_iterator","_createForOfIteratorHelper","s","_step","n","done","tweet","value","anchors","tweetId","length","href","match","replace","push","err","e","f","ftf_aet","config","use_api","fetch","method","credentials","headers","Content-Type","Cache-Control","body","URLSearchParams","action","tweet_ids","join","then","response","json","data","renderTweet","_step2","_iterator2","dataset","urlAttachmentProcessed","ajax_url","concat","urlAttachment","urlAttachmentPreview","tmpAnchor","urlAttachmentPreviewHTML","image","createElement","className","title","description","hostname","innerHTML","querySelector","appendChild","_loop","error","_iterator3","_step3","tweetDate","childNodes","textContent","i","currentNode","nodeName","nodeValue","tweetAttribution","tweetDateEl","usernames","name","username","names","split","created_at","text","users","tweetUrl","id","verifiedBadge","renderedTweetHTML","profile_image_url","entities","urls","forEach","url","tweetText","display_url","indexOf","RegExp","expanded_url","mentions","mention","hashtags","hashtag","verified","tag","media","index","type","preview_image_url","width","height","polls","poll","voteCounts","votesTotal","options","map","option","votes","Math","max","apply","_toConsumableArray","reduce","total","num","votesPortion","voteCountMax","label","round","toLocaleString","Date","toLocaleDateString","navigator","language","month","year","day","show_metrics","public_metrics","retweet_count","like_count","renderedTweet","lastUrl","extended_entities","parentNode","replaceChild"],"mappings":"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","file":"scripts.min.js","sourcesContent":["'use strict';\nconst ftfHelpers = {\n    ready: function( fn ) {\n        if ( document.readyState != 'loading' ){\n            fn();\n        } else {\n            document.addEventListener( 'DOMContentLoaded', fn );\n        }\n    },\n    processTweets: function(){\n        const tweets = document.querySelectorAll( 'blockquote.twitter-tweet' );\n        let tweetIds = [];\n\n        for ( const tweet of tweets ) {\n            const anchors = tweet.querySelectorAll( 'a' );\n            const url = anchors[anchors.length - 1].href;\n            const tweetId = url.match(/status\\/(\\d+)/g)[0].replace( 'status/', '' );\n            tweetIds.push( tweetId );\n            tweet.dataset.tweetId = tweetId;\n        }\n\n        // console.log( 'tweet IDs', tweetIds );\n\n        if ( tweetIds.length ){\n            if ( ftf_aet.config.use_api ){\n                fetch( window.ftf_aet.ajax_url, {\n                    method: 'POST',\n                    credentials: 'same-origin',\n                    headers: {\n                        'Content-Type': 'application/x-www-form-urlencoded',\n                        'Cache-Control': 'no-cache',\n                    },\n                    body: new URLSearchParams( {\n                        action: 'ftf_embed_tweet',\n                        tweet_ids: tweetIds.join( ',' )\n                    } ) } )\n                    .then(function( response ){ return response.json() } )\n                    .then( function( response ){\n                        // console.log( 'response', response );\n                       if ( response && response.length ){\n                            response.forEach( function( data ){\n                                ftfHelpers.renderTweet( data );\n                            } );\n\n                            const tweetsWithAttachment = document.querySelectorAll( '[data-url-attachment-processed=\"false\"]' );\n\n                            // console.log( 'tweetsWithAttachment', tweetsWithAttachment );\n\n                            for ( const tweet of tweetsWithAttachment ) {\n                                tweet.dataset.urlAttachmentProcessed = 'true';\n                                \n                                fetch( `https://fourtonfish.com/sitesummary/?url=${ tweet.dataset.urlAttachment }` ).then( function( response ) { \n                                    return response.json();\n                                } ).then( function( data ) {\n                                    // console.log( 'sitesummary', data ); \n                                    if ( data && data.image ){\n                                        let urlAttachmentPreview = document.createElement( 'div' );\n                                        urlAttachmentPreview.className = `tweet-attachment-preview card mt-4`;\n\n                                        let tmpAnchor = document.createElement ( 'a' );\n                                        tmpAnchor.href = tweet.dataset.urlAttachment;\n\n                                        let urlAttachmentPreviewHTML = '';\n\n                                        if ( data.image ){\n                                            urlAttachmentPreviewHTML += `<img loading=\"lazy\" class=\"tweet-attachment-site-thumbnail card-img-top\" src=\"${ data.image }\" alt=\"\">`;\n                                        }\n\n                                        urlAttachmentPreviewHTML += `<div class=\"card-body\">`;\n\n                                        if ( data.title ){\n                                            urlAttachmentPreviewHTML += `<h5 class=\"card-title\">${ data.title }</h5>`;\n                                        }\n\n                                        if ( data.description ){\n                                            urlAttachmentPreviewHTML += `<h6 class=\"card-subtitle mb-2 text-muted\">${ data.description }</h6>`;\n                                        }\n\n                                        urlAttachmentPreviewHTML += `<p class=\"card-text\">🔗 <a class=\"stretched-link text-muted\" href=\"${ tweet.dataset.urlAttachment }\" target=\"_blank\">${ tmpAnchor.hostname }</a></p></div>`;\n\n                                        urlAttachmentPreview.innerHTML = urlAttachmentPreviewHTML;\n                                        tweet.querySelector( '.tweet-body-wrapper' ).appendChild( urlAttachmentPreview );\n                                    }\n                                } );\n                            }\n                        }\n                    } )\n                    .catch( function( error ){\n                        console.error( 'ftf_aet_error', error );\n                    } );\n            } else {\n\n                for ( const tweet of tweets ) {\n                    // console.log( 'debug:tweet', tweet );\n                    // console.log( 'debug:childNodes', tweet.childNodes );\n\n                    let tweetAttribution = '', tweetDate = '';\n\n                    if ( tweet.childNodes && tweet.childNodes.length ){\n                        if ( tweet.childNodes.length === 3 ){\n                            tweetDate = tweet.childNodes[2].textContent;\n                            for ( let i = 0; i < tweet.childNodes.length; i++ ){\n                                let currentNode = tweet.childNodes[i];\n                                if ( currentNode.nodeName === '#text' ) {\n                                    tweetAttribution = currentNode.nodeValue;\n                                    break;\n                                }\n                            }                        \n                        } else {\n                            tweetAttribution = tweet.childNodes[tweet.childNodes.length - 2].innerHTML;\n                            let tweetDateEl = document.createElement( 'div' );\n                            tweetDateEl.innerHTML = tweetAttribution;\n                            tweetDate = tweetDateEl.querySelector( 'a' ).textContent;\n                        }\n\n                        const usernames = tweetAttribution.match( /@\\w+/gi );\n                        let name = '', username = '';\n                        // console.log( 'debug:tweetDate', tweetDate );\n\n                        if ( usernames && usernames[0] ){\n                            username = usernames[0];\n                            const names = tweetAttribution.split( username );\n                            // console.log( 'debug:names', usernames );\n\n                            if ( names && names[0] ){\n                                name = names[0].replace( '— ', '' ).replace( ' (', '' );\n                            }\n                        }\n\n                        ftfHelpers.renderTweet( {\n                          'created_at': tweetDate,\n                          'text': tweet.querySelector( 'p' ).innerHTML,\n                          'id': tweet.dataset.tweetId,\n                          // 'author_id': '',\n                          'users': [\n                            {\n                              'name': name,\n                              'username': username.replace(/^@/, ''),\n                              // 'id': '',\n                              // 'profile_image_url': '',\n                              // 'verified': false\n                            }\n                          ]\n                        } );                    \n                    }\n                }\n            }\n        }\n    },\n    renderTweet: function( data ){\n        // console.log( 'debug:', data );\n        let tweetText = data.text,\n            tweetUrl = `https://twitter.com/${ data.users[0].username }/status/${ data.id }`,\n            entities = null,\n            verifiedBadge = data.users[0].verified ? '<svg class=\"tweet-verified-user-badge\" viewBox=\"0 0 24 24\" aria-label=\"Verified account\" class=\"r-13gxpu9 r-4qtqp9 r-yyyyoo r-1xvli5t r-9cviqr r-dnmrzs r-bnwqim r-1plcrui r-lrvibr\"><g><path d=\"M22.5 12.5c0-1.58-.875-2.95-2.148-3.6.154-.435.238-.905.238-1.4 0-2.21-1.71-3.998-3.818-3.998-.47 0-.92.084-1.336.25C14.818 2.415 13.51 1.5 12 1.5s-2.816.917-3.437 2.25c-.415-.165-.866-.25-1.336-.25-2.11 0-3.818 1.79-3.818 4 0 .494.083.964.237 1.4-1.272.65-2.147 2.018-2.147 3.6 0 1.495.782 2.798 1.942 3.486-.02.17-.032.34-.032.514 0 2.21 1.708 4 3.818 4 .47 0 .92-.086 1.335-.25.62 1.334 1.926 2.25 3.437 2.25 1.512 0 2.818-.916 3.437-2.25.415.163.865.248 1.336.248 2.11 0 3.818-1.79 3.818-4 0-.174-.012-.344-.033-.513 1.158-.687 1.943-1.99 1.943-3.484zm-6.616-3.334l-4.334 6.5c-.145.217-.382.334-.625.334-.143 0-.288-.04-.416-.126l-.115-.094-2.415-2.415c-.293-.293-.293-.768 0-1.06s.768-.294 1.06 0l1.77 1.767 3.825-5.74c.23-.345.696-.436 1.04-.207.346.23.44.696.21 1.04z\"></path></g></svg>' : '',\n            renderedTweetHTML = `<div class=\"card w-100\">\n                <div class=\"tweet-body-wrapper card-body pt-4\">\n                    <div class=\"card-text\">\n                        <div class=\"row no-gutters mb-1\">`;\n\n            if ( data.users[0].profile_image_url ){\n                renderedTweetHTML += `<div class=\"col-2 col-sm-1 col-md-1\">\n                    <a href=\"https://twitter.com/${ data.users[0].username }\" class=\"text-decoration-none\"><img loading=\"lazy\" class=\"rounded-circle border\" width=\"48\" height=\"48\" src=\"${ data.users[0].profile_image_url }\"></a>\n                </div>`;\n            }\n\n            renderedTweetHTML += `<div class=\"tweet-author ${ data.users[0].profile_image_url ? 'col-9 col-sm-10 col-md-10 pl-2' : 'col-11 col-sm-11 col-md-11' } pb-3\">\n                <p class=\"font-weight-bold mb-0 mt-0\"><a class=\"text-dark text-decoration-none\" href=\"https://twitter.com/${ data.users[0].username }\">${ data.users[0].name }${ verifiedBadge }</a></p>\n                <p class=\"mb-1 mb-md-2 mt-0\"><a class=\"text-muted text-decoration-none\" href=\"https://twitter.com/${ data.users[0].username }\">@${ data.users[0].username }</a></p>\n            </div>\n            <div class=\"col-1 text-right\">\n                <a href=\"${ tweetUrl }\" target=\"_blank\"><svg style=\"width: 24px;\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path d=\"M512 97.248c-19.04 8.352-39.328 13.888-60.48 16.576 21.76-12.992 38.368-33.408 46.176-58.016-20.288 12.096-42.688 20.64-66.56 25.408C411.872 60.704 384.416 48 354.464 48c-58.112 0-104.896 47.168-104.896 104.992 0 8.32.704 16.32 2.432 23.936-87.264-4.256-164.48-46.08-216.352-109.792-9.056 15.712-14.368 33.696-14.368 53.056 0 36.352 18.72 68.576 46.624 87.232-16.864-.32-33.408-5.216-47.424-12.928v1.152c0 51.008 36.384 93.376 84.096 103.136-8.544 2.336-17.856 3.456-27.52 3.456-6.72 0-13.504-.384-19.872-1.792 13.6 41.568 52.192 72.128 98.08 73.12-35.712 27.936-81.056 44.768-130.144 44.768-8.608 0-16.864-.384-25.12-1.44C46.496 446.88 101.6 464 161.024 464c193.152 0 298.752-160 298.752-298.688 0-4.64-.16-9.12-.384-13.568 20.832-14.784 38.336-33.248 52.608-54.496z\" fill=\"#03a9f4\"/></svg></a>\n            </div>\n        </div>\n        <div class=\"tweet-body\">`;\n\n        if ( data.entities ){\n            if ( data.entities.urls ){\n                data.entities.urls.forEach( function( url ){\n                    if ( url.display_url.indexOf( 'pic.twitter.com' ) === -1 ){\n                        tweetText = tweetText.replace( RegExp( url.url, 'ig' ), `<a href=\"${ url.expanded_url }\" target=\"_blank\">${ url.display_url }</a>` )\n                    } else {\n                        tweetText = tweetText.replace( url.url, '' );\n                    }\n                } );\n            }\n\n            if ( data.entities.mentions ){\n                data.entities.mentions.forEach( function( mention ){\n                    tweetText = tweetText.replace( RegExp( `@${ mention.username }`, 'ig' ), `<a href=\"https://twitter.com/${ mention.username }\" target=\"_blank\">@${ mention.username }</a>` );\n                } );\n            }\n\n            if ( data.entities.hashtags ){\n                data.entities.hashtags.forEach( function( hashtag ){\n                    tweetText = tweetText.replace( RegExp( `#${ hashtag.tag }`, 'ig' ), `<a href=\"https://twitter.com/hashtag/${ hashtag.tag }\" target=\"_blank\">#${ hashtag.tag }</a>` );\n                } );\n            }\n        }\n\n        if ( data.media && data.media.length ){\n            tweetText += `<div data-media-length=\"${ data.media.length }\" class=\"tweet-media row mt-3 no-gutters\">`;\n\n            data.media.forEach( function( media, index ){\n                if ( data.media.length === 1 ){\n                    tweetText += `<div data-media-type=\"${ media.type }\" class=\"text-center col-sm-12 col-md-12 col-lg-12\">`;\n                } else if ( data.media.length === 3 ){\n                    if ( index === 2 ){\n                        tweetText += `<div data-media-type=\"${ media.type }\" class=\"text-center col-sm-12 col-md-12 col-lg-12\">`;\n                    } else {\n                        tweetText += `<div data-media-type=\"${ media.type }\" class=\"text-center col-sm-12 col-md-6 col-lg-6\">`;\n                    }\n                } else if ( data.media.length > 1 && data.media.length < 5 ){\n                    tweetText += `<div data-media-type=\"${ media.type }\" class=\"text-center col-sm-12 col-md-6 col-lg-6\">`;\n                } else {\n                    tweetText += `<div data-media-type=\"${ media.type }\" class=\"text-center col-sm-12 col-md-3 col-lg-3\">`;\n                }\n\n                if ( media.type === 'animated_gif' ){\n                    tweetText += `<video class=\"w-100 mt-0\" controls loop><source src=\"${ media.preview_image_url.replace( 'pbs.twimg.com/tweet_video_thumb', 'video.twimg.com/tweet_video' ).replace( '.jpg', '.mp4').replace( '.png', '.mp4') }\" type=\"video/mp4\"></video>`\n                } else if ( media.type === 'video' ){\n                    /* TODO: Video URLs not being passed in Twitter API v2.\n                       https://twittercommunity.com/t/how-do-i-get-the-video-url-in-recent-search/141896\n                    */\n                    tweetText += `<a class=\"tweet-video-placeholder\" href=\"${ tweetUrl }\" target=\"_blank\"><img loading=\"lazy\" width=\"${ media.width }\" height=\"${ media.height }\" class=\"w-100 rounded border\" src=\"${ media.preview_image_url }\"></a>`;\n\n                } else if ( media.type === 'photo' ){\n                    tweetText += `<a href=\"${ tweetUrl }\" target=\"_blank\"><img loading=\"lazy\" width=\"${ media.width }\" height=\"${ media.height }\" class=\"w-100 rounded border\" src=\"${ media.url }\"></a>`;\n                }\n\n                tweetText += '</div>';\n            } );\n\n            tweetText += '</div>';\n        }\n\n\n        if ( data.polls && data.polls.length ){\n            tweetText += '<div class=\"mt-0 row\">';\n\n            data.polls.forEach( function( poll ){\n                if ( poll.options && poll.options.length ){\n\n                    const voteCounts = poll.options.map( function( option ){\n                        return option.votes;\n                    } );\n\n                    const voteCountMax = Math.max( ...voteCounts );\n                    const votesTotal = voteCounts.reduce( function( total, num ){\n                        return total + num;\n                    } );\n\n                    poll.options.forEach( function( option ){\n                        const votesPortion = option.votes/votesTotal * 100;\n                        tweetText += `\n                        <div class=\"tweet-poll-results col-9\" style=\"height:60px;\">\n                            <div class=\"progress position-relative mt-n4 ${ option.votes === voteCountMax ? ' border border-primary ' : '' }\" style=\"height:30px;\">\n                                <div class=\"progress-bar\" \n                                     role=\"progressbar\" \n                                     style=\"width: ${ votesPortion }%\" \n                                     aria-valuenow=\"${ votesPortion }\" \n                                     aria-valuemin=\"0\" \n                                     aria-valuemax=\"100\"></div>\n                                <span class=\"pl-2 d-flex position-absolute w-100\" style=\"font-size: 1rem; line-height: 30px;\">${ option.label }</span>\n                            </div>\n                        </div>\n                        <div class=\"col-3 mt-n4 text-right\" style=\"height:60px;\">\n                            <span class=\"w-100\">${ Math.round( option.votes/votesTotal * 100 ) }%</span>\n                        </div>`;\n                    } );\n                    tweetText += `<div class=\"col-12 mt-3\"><p class=\"text-muted\">${ votesTotal.toLocaleString() } votes</p></div>`;\n                }\n            } );\n\n            tweetText += '</div>';\n        }                    \n\n        const tweetDate = new Date( data.created_at ).toLocaleDateString( navigator.language, { month: 'long', year: 'numeric', day: 'numeric' } );\n\n        renderedTweetHTML += tweetText + `</div>\n                </div>\n            </div>\n            <div class=\"card-footer\">`;\n\n        if ( ftf_aet.config.show_metrics && data.public_metrics ){\n            renderedTweetHTML += `\n                🔁 <a class=\"text-muted\" href=\"${ tweetUrl }\" target=\"_blank\">${ data.public_metrics.retweet_count.toLocaleString() }</a> |\n                ❤️ <a class=\"text-muted\" href=\"${ tweetUrl }\" target=\"_blank\">${ data.public_metrics.like_count.toLocaleString() }</a> | `;\n\n        }\n                    \n        renderedTweetHTML += `<a class=\"text-muted\" href=\"${ tweetUrl }\" target=\"_blank\">${ tweetDate }</a>\n            </div>\n        </div>`;\n        \n        let renderedTweet = document.createElement( 'div' );\n        renderedTweet.className = `twitter-tweet twitter-tweet-rendered w-100`;\n        renderedTweet.innerHTML = renderedTweetHTML;\n\n        let lastUrl = '';\n\n        if ( data.entities && data.entities.urls && data.entities.urls.length ){\n            lastUrl = data.entities.urls[data.entities.urls.length - 1];\n        }\n\n        if ( ( data.media && data.media.length ) || data.extended_entities && data.extended_entities.media && data.extended_entities.media.length ){\n            lastUrl = '';\n        }\n\n        if ( lastUrl ){\n            renderedTweet.dataset.urlAttachment = lastUrl.expanded_url;\n            renderedTweet.dataset.urlAttachmentProcessed = 'false';\n        }\n\n        const tweet = document.querySelector( `[data-tweet-id=\"${ data.id }\"]` );\n        tweet.parentNode.replaceChild( renderedTweet, tweet );\n\n        // if ( data.id === '1214098949918875648' ){\n            // console.log( renderedTweet, data );\n        // }\n    }\n}\n\nftfHelpers.ready( function(){\n    ftfHelpers.processTweets();\n} );\n"]}